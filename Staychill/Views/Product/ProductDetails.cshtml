@model Staychill.Models.ProductModel.Product

@{
    ViewData["Title"] = "Product Details";
}

<div class="container mt-4">
    <div class="row">
        <!-- โซนแสดงภาพสินค้า -->
        <div class="col-md-6">
            @if (Model.Images != null && Model.Images.Image1 != null)
            {
                <img src="@($"data:image/png;base64,{Convert.ToBase64String(Model.Images.Image1)}")" alt="Main Image" class="img-fluid rounded" />
            }
            else
            {
                <p>No Image Available</p>
            }
        </div>

        <!-- โซนแสดงรายละเอียดสินค้า -->
        <div class="col-md-6">
            <h2>@Model.ProductName</h2>
            <p>@Model.Description</p>

            <!-- โซนกรองสี -->
            <p><strong>Color:</strong></p>
            <div class="d-flex gap-2">
                @if (ViewBag.RelatedColors != null)
                {
                    foreach (var colorItem in ViewBag.RelatedColors)
                    {
                        <a asp-action="ProductDetails" asp-route-id="@colorItem.Id" style="text-decoration: none;">
                            <span class="d-inline-block" style="width: 20px; height: 20px; background-color: @colorItem.Color; border-radius: 50%; border: 1px solid #000; cursor: pointer;" title="@colorItem.Color"></span>
                        </a>
                    }
                }
            </div>

            <!-- เพิ่มส่วนแสดงราคาสินค้า -->
            <p class="mt-3">
                <strong>Price:</strong>
                <span style="font-size: 1.5rem;">@String.Format("{0:C}", Model.Price)</span> <!-- ปรับขนาดตัวอักษรที่นี่ -->
            </p>


            <!-- ฟอร์มเพิ่มสินค้า -->
            <div class="mt-4">
                <form asp-action="CartIndex" asp-controller="Cart" method="post">
                    <input type="hidden" name="productId" value="@Model.Id" />
                    <label for="quantity">Quantity:</label>
                    <div class="d-flex align-items-center">
                        <button type="button" class="btn btn-secondary" onclick="this.nextElementSibling.stepDown()">-</button>
                        <input type="number" name="quantity" value="1" min="1" max="@Model.Instock" class="form-control mx-2" style="width: 60px; text-align: center;" />
                        <button type="button" class="btn btn-secondary" onclick="this.previousElementSibling.stepUp()">+</button>
                    </div>
                    <button type="submit" class="btn btn-primary mt-3">Add to Cart</button>
                </form>
            </div>
        </div>


    <!-- โซนแสดงภาพเพิ่มเติม -->
    <div class="mt-4">
        <div class="row">
            @if (Model.Images != null)
            {
                <div class="col-4 col-md-3 col-lg-2">
                    @if (Model.Images.Image2 != null)
                    {
                        <img src="@($"data:image/png;base64,{Convert.ToBase64String(Model.Images.Image2)}")" alt="Image 2" class="img-fluid mb-2 rounded" />
                    }
                </div>
                <div class="col-4 col-md-3 col-lg-2">
                    @if (Model.Images.Image3 != null)
                    {
                        <img src="@($"data:image/png;base64,{Convert.ToBase64String(Model.Images.Image3)}")" alt="Image 3" class="img-fluid mb-2 rounded" />
                    }
                </div>
                <div class="col-4 col-md-3 col-lg-2">
                    @if (Model.Images.Image4 != null)
                    {
                        <img src="@($"data:image/png;base64,{Convert.ToBase64String(Model.Images.Image4)}")" alt="Image 4" class="img-fluid mb-2 rounded" />
                    }
                </div>
            }
        </div>
    </div>

    <!-- โซนแสดงสินค้าอื่นๆ ที่สุ่มมา -->
    <div class="mt-4">
        <h3>Others</h3>
        <div class="row">
            @if (ViewBag.OtherProducts != null)
            {
                foreach (var otherProduct in ViewBag.OtherProducts)
                {
                    <div class="col-6 col-md-4 col-lg-3">
                        <div class="text-center">
                            @if (otherProduct.Images != null && otherProduct.Images.Image1 != null)
                            {
                                var base64Image = Convert.ToBase64String(otherProduct.Images.Image1);
                                <a href="@Url.Action("ProductDetails", "Product", new { id = otherProduct.Id })">
                                    <img src="@($"data:image/png;base64,{base64Image}")" alt="Image1" class="img-fluid mb-2 rounded" />
                                </a>
                            }
                            else
                            {
                                <p>No Image Available</p>
                            }
                        </div>
                    </div>
                }
            }
            else
            {
                <p>No other products available.</p>
            }
        </div>
    </div>

    <a asp-action="ProductMainPage" class="btn btn-link mt-4">Back</a>
</div>
